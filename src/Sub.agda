
module Sub where

open import Foundations.Base
open import Data.List
open import Data.String

open import In
open import All

private variable
  A : ğ’°
  a : A
  Î“ Î” Î• Î¦ : List A

_âŠ‚_ : List A â†’ List A â†’ ğ’°
Î“ âŠ‚ Î” = All (_âˆˆ Î”) Î“

_â—‚_ : (ptr : a âˆˆ Î“) (sub : Î“ âŠ‚ Î”) â†’ a âˆˆ Î”
ğŸ™ â—‚ (x âˆ· sub) = x
(ğŸ˜âˆ· ptr) â—‚ (x âˆ· sub) = ptr â—‚ sub

_â€¢_ : (Î“âŠ‚Î” : Î“ âŠ‚ Î”) (Î”âŠ‚Î• : Î” âŠ‚ Î•) â†’ Î“ âŠ‚ Î•
[] â€¢ Î”âŠ‚Î• = []
(x âˆ· Î“âŠ‚Î”) â€¢ Î”âŠ‚Î• = (x â—‚ Î”âŠ‚Î•) âˆ· (Î“âŠ‚Î” â€¢ Î”âŠ‚Î•)

âŸ¨ğŸ˜â‹¯ğŸ˜âŸ©âˆ·_ : (Î“âŠ‚Î” : Î“ âŠ‚ Î”) â†’ Î“ âŠ‚ (Î• ++ Î”)
âŸ¨ğŸ˜â‹¯ğŸ˜âŸ©âˆ·_ {Î• = []} Î“âŠ‚Î” = Î“âŠ‚Î”
âŸ¨ğŸ˜â‹¯ğŸ˜âŸ©âˆ·_ {Î• = x âˆ· Î•} [] = []
âŸ¨ğŸ˜â‹¯ğŸ˜âŸ©âˆ·_ {Î• = x âˆ· Î•} (xâ‚ âˆ· Î“âŠ‚Î”) = (ğŸ˜â‹¯ğŸ˜âˆ· xâ‚) âˆ· (âŸ¨ğŸ˜â‹¯ğŸ˜âŸ©âˆ· Î“âŠ‚Î”)

infixr 4.5 âŸ¨ğŸ˜â‹¯ğŸ˜âŸ©âˆ·_

âŸ¨ğŸ˜âŸ©âˆ·_ : (Î“âŠ‚Î” : Î“ âŠ‚ Î”) â†’ Î“ âŠ‚ (a ++ Î”)
âŸ¨ğŸ˜âŸ©âˆ·_ = âŸ¨ğŸ˜â‹¯ğŸ˜âŸ©âˆ·_

_âŠ•_ : (Î“âŠ‚Î” : Î“ âŠ‚ Î”) (Î•âŠ‚Î¦ : Î• âŠ‚ Î¦) â†’ (Î“ ++ Î•) âŠ‚ (Î” ++ Î¦)
[] âŠ• Î•âŠ‚Î¦ = âŸ¨ğŸ˜â‹¯ğŸ˜âŸ©âˆ· Î•âŠ‚Î¦
(x âˆ· Î“âŠ‚Î”) âŠ• Î•âŠ‚Î¦ = (x âˆ·ğŸ˜â‹¯ğŸ˜) âˆ· (Î“âŠ‚Î” âŠ• Î•âŠ‚Î¦)

ğŸ™â‹¯ğŸ™ : Î“ âŠ‚ Î“
ğŸ™â‹¯ğŸ™ {Î“ = []} = []
ğŸ™â‹¯ğŸ™ {Î“ = x âˆ· Î“} = ğŸ™ âˆ· map-all ğŸ˜âˆ·_ ğŸ™â‹¯ğŸ™
